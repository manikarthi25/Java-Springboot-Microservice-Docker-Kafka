package com.service.kafka.service.impl;

import java.util.concurrent.ExecutionException;

import org.springframework.messaging.handler.annotation.Payload;
import org.springframework.stereotype.Service;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.service.kafka.constant.ErrorConstant;
import com.service.kafka.constant.MessageConstant;
import com.service.kafka.exception.AppException;
import com.service.kafka.model.PurchaseOrder;

@Service
public class PurchaseOrderProducer {
	
	public void producer(String message) throws AppException {

		try {
			String message = objectMapper.writerWithDefaultPrettyPrinter().writeValueAsString(purchaseOrder);
			kafkaTemplate.send(kafkaConfig.getPoTopicName(), message).get();
		} catch (InterruptedException | ExecutionException | JsonProcessingException e) {
			e.printStackTrace();
		}
	}

}
